<source>
  type tail
  path /var/lib/docker/containers/*/*-json.log
  pos_file /var/lib/docker/containers/containers.log.pos
  tag docker.log.*
	time_format %Y-%m-%dT%H:%M:%S 
	format json
</source>

<match docker.log.**>
  type docker_tag_resolver
</match>

<match docker.container.**>
  type record_reformer
	tag processed.${tag}
	
  <record>
    host "#{ENV['HOST']}"
		id ${hostname}
    image ${tag_parts[2]}
		name ${tag_parts[-2]}
  </record>
</match>

<match processed.docker.container.**>
  type file
  path /var/lib/docker/containers/*.log
	format json
	include_time_key
</match>
